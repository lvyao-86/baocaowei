<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>作业_记录商品浏览记录</title>
	<style>	
			ul{	
				/*width: 900px;*/
			}
			li{list-style: none;
				width: 300px;height: 400px;float: left;
				margin-left: 10px;text-align: center;
				padding-top: 10px;
			}
			li:hover{background: #efefef}
	</style>
	<script src='../common.js'>
	</script>
	<script>
	window.onload = function(){
		var goodslist = [{
			"imgurl":"images/160.jpg",
			"title":"Bottega Veneta/葆蝶家 女士牛皮粉色钱包 114076 V0041 6811",
			"price":5186,
			"guid":"g001"
		},{
			"imgurl":"images/161.jpg",
			"title":"Bottega Veneta/葆蝶家 时尚拼色小羊皮手提包",
			"price":21128,
			"guid":"g002"
		},{
			"imgurl":"images/162.jpg",
			"title":"Bottega Veneta/葆蝶家 BV男包手拿包羊皮 224053 V4651 1000",
			"price":10461,
			"guid":"g003"
		},{
			"imgurl":"images/163.jpg",
			"title":"Bottega Veneta/葆蝶家手提包",
			"price":15278,
			"guid":"g004"
		},{
			"imgurl":"images/164.jpg",
			"title":"[16秋冬]Bottega Veneta/葆蝶家 女士 羊皮 编织纹理 单肩包 DU",
			"price":23644,
			"guid":"g005"
		},{
			"imgurl":"images/165.jpg",
			"title":"Bottega Veneta/葆蝶家 女士黑色羊皮斜挎包 354761 V0016 8175",
			"price":23254,
			"guid":"g006"
		},{
			"imgurl":"images/166.jpg",
			"title":"Bottega Veneta/葆蝶家 经典编织设计浅蓝色羊皮女士长款钱包#302357 V001N 4906",
			"price":5556,
			"guid":"g007"
		},{
			"imgurl":"images/167.jpg",
			"title":"Bottega Veneta/葆蝶家 女士咖色羊皮短款钱包# 335531 V4651 2314",
			"price":2951,
			"guid":"g008"
		},{
			"imgurl":"images/168.jpg",
			"title":"Bottega Veneta/葆蝶家 女士牛皮黑色手拿包 407255 V001N 1000",
			"price":7636,
			"guid":"g009"
		},{
			"imgurl":"images/169.jpg",
			"title":"Bottega Veneta/葆蝶家 女士酒红色编织小羊皮单肩包 245354 V0016 2289",
			"price":12076,
			"guid":"g010"
		}];
		var goods=document.getElementsByClassName('goods')[0];
		var ul=document.createElement('ul');
		ul.innerHTML=goodslist.map(function(item){
			return '<li><img src="'+item.imgurl+'"><p>'+item.title+'</p><p>'+item.price+'</p></li>';
		})
		goods.appendChild(ul);
		goodslist = goodslist ? JSON.parse(goodslist) : [];

		goodslist.onclick=function(){
			e = e || window.event;
				var target = e.target || e.srcElement;

				if(target.tagName.toLowerCase() === 'img'){
					// 获取当前li
					var currentLi = target.parentNode;

					// 获取当前商品的guid
					var guid = currentLi.getAttribute('data-guid');

					// 关键：判断当前商品是否存在cookie
					for(var i=0;i<goodslist.length;i++){
						if(goodslist[i].guid === guid){
							goodslist[i].qty++;
							break;
						}
					}

					// 商品不存cookie中
					if(i===goodslist.length){
						// 获取<当前>商品的信息
						var goods = {
							guid:guid,
							imgurl:currentLi.children[0].src,
							title:currentLi.children[1].innerText,
							price:currentLi.children[2].innerText,
							qty:1
						};

						// 往数组中添加当前商品
						goodslist.push(goods);
					}
					console.log(goodslist)
					

					// 设置cookie
					// cookie保存的是字符串
					// JSON.stringify()：把对象/数组转成json字符串
					setCookie('goodslist',JSON.stringify(goodslist));
				}
			
		}
	}
		
	
	</script>
</head>
<body>
	<div class="goods">
	</div>
</body>
</html>